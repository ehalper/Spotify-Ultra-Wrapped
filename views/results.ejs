<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Results</title>
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css">
</head>

<body>
    <h1 class="inline">Spotify Ultra Wrapped</h1> 
	<img style="width: 135px" ; src="spotifyLogo.png" /> 
    <br>
    <div style="display: inline-block;">
        <%- tableStr %> &nbsp;
            <%- tableStr2 %> &nbsp;
                <%- tableStr3 %> &nbsp;
                    <%- tableStr4 %> &nbsp; &nbsp; &nbsp;

                        <div id="chartContainer" class="chart"></div>

    </div>

    <script>
        window.onload = function () {
            let val1 = `<%- topAppearances[0] %>` / `<%- totalSongs %>` * 100
            let val2 = `<%- topAppearances[1] %>` / `<%- totalSongs %>` * 100
            let val3 = `<%- topAppearances[2] %>` / `<%- totalSongs %>` * 100
            let val4 = `<%- topAppearances[3] %>` / `<%- totalSongs %>` * 100
            let val5 = `<%- topAppearances[4] %>` / `<%- totalSongs %>` * 100
            let val6 = `<%- topAppearances[5] %>` / `<%- totalSongs %>` * 100
            let val7 = `<%- topAppearances[6] %>` / `<%- totalSongs %>` * 100
            let val8 = `<%- topAppearances[7] %>` / `<%- totalSongs %>` * 100
            let val9 = `<%- topAppearances[8] %>` / `<%- totalSongs %>` * 100
            let val10 = `<%- topAppearances[9] %>` / `<%- totalSongs %>` * 100


            var chart = new CanvasJS.Chart("chartContainer", {
                animationEnabled: true,
                title: {
                    text: "Top Artists from Spotify Wrapped Songs Over <%- numYears %> Years"
                },
                data: [{
                    type: "pie",
                    startAngle: 240,
                    yValueFormatString: "##0.00\"%\"",
                    indexLabel: "{label} {y}",
                    dataPoints: [
                        { y: val1, label: `<%- topOverallArtists[0] %>` + '(' + `<%- topAppearances[0] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val2, label: `<%- topOverallArtists[1] %>` + '(' + `<%- topAppearances[1] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val3, label: `<%- topOverallArtists[2] %>` + '(' + `<%- topAppearances[2] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val4, label: `<%- topOverallArtists[3] %>` + '(' + `<%- topAppearances[3] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val5, label: `<%- topOverallArtists[4] %>` + '(' + `<%- topAppearances[4] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val6, label: `<%- topOverallArtists[5] %>` + '(' + `<%- topAppearances[5] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val7, label: `<%- topOverallArtists[6] %>` + '(' + `<%- topAppearances[6] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val8, label: `<%- topOverallArtists[7] %>` + '(' + `<%- topAppearances[7] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val9, label: `<%- topOverallArtists[8] %>` + '(' + `<%- topAppearances[8] %>` + '/' + `<%- totalSongs %>)` },
                        { y: val10, label: `<%- topOverallArtists[9] %>` + '(' + `<%- topAppearances[9] %>` + '/' + `<%- totalSongs %>)` },
                        { y: 100-(val1+val2+val3+val4+val5+val6+val7+val8+val9+val10), label: "Rest" }
                    ]


                }]
            });
            chart.render();

        }
    </script>



    <hr>

    <h2>Songs from More than One Spotify Wrapped Year</h2>

    <%- commonSongsTable %> &nbsp;

</body>

</html>